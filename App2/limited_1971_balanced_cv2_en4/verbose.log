Fold 0
Command line
python train.py --data_path ./App2/ligands2.csv --save_dir ./App2/limited_1971_balanced_cv2_en4 --dataset_type classification --class_balance --num_folds 2 --ensemble_size 4
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': True,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': './App2/ligands2.csv',
 'dataset_type': 'classification',
 'depth': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'ensemble_size': 4,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'auc',
 'minimize_score': False,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 2,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': './App2/limited_1971_balanced_cv2_en4\\fold_0',
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['activity'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 0
Class sizes
activity 0: 47.06%, 1: 52.94%
Total size = 1,970 | train size = 1,576 | val size = 197 | test size = 197
With class_balance, effective train size = 1,516
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 354,901
Epoch 0
Loss = 1.2872e-02, PNorm = 34.0190, GNorm = 0.4123, lr_0 = 2.5968e-04
Loss = 1.0698e-02, PNorm = 34.0615, GNorm = 0.4561, lr_0 = 4.0484e-04
Loss = 7.9899e-03, PNorm = 34.1452, GNorm = 0.4406, lr_0 = 5.5000e-04
Loss = 2.2086e-02, PNorm = 34.1536, GNorm = 2.4401, lr_0 = 5.6452e-04
Validation auc = 0.938669
Epoch 1
Loss = 6.0295e-03, PNorm = 34.2239, GNorm = 2.2745, lr_0 = 7.0968e-04
Loss = 6.9254e-03, PNorm = 34.2485, GNorm = 0.8621, lr_0 = 8.5484e-04
Loss = 6.4844e-03, PNorm = 34.2890, GNorm = 1.5475, lr_0 = 1.0000e-03
Loss = 1.4405e-02, PNorm = 34.2959, GNorm = 3.2324, lr_0 = 9.9735e-04
Validation auc = 0.946064
Epoch 2
Loss = 6.2312e-03, PNorm = 34.3560, GNorm = 1.6535, lr_0 = 9.7124e-04
Loss = 5.3699e-03, PNorm = 34.3982, GNorm = 0.4666, lr_0 = 9.4582e-04
Loss = 5.1477e-03, PNorm = 34.4291, GNorm = 0.7344, lr_0 = 9.2106e-04
Loss = 2.0546e-02, PNorm = 34.4307, GNorm = 2.7630, lr_0 = 9.1862e-04
Validation auc = 0.947695
Epoch 3
Loss = 4.5936e-03, PNorm = 34.4649, GNorm = 0.4552, lr_0 = 8.9457e-04
Loss = 5.1798e-03, PNorm = 34.5041, GNorm = 0.9754, lr_0 = 8.7115e-04
Loss = 5.5108e-03, PNorm = 34.5395, GNorm = 4.1920, lr_0 = 8.4834e-04
Validation auc = 0.962701
Epoch 4
Loss = 5.4482e-03, PNorm = 34.5676, GNorm = 2.8563, lr_0 = 8.2613e-04
Loss = 5.0124e-03, PNorm = 34.6094, GNorm = 1.4091, lr_0 = 8.0451e-04
Loss = 4.4263e-03, PNorm = 34.6472, GNorm = 0.7937, lr_0 = 7.8345e-04
Validation auc = 0.960309
Epoch 5
Loss = 4.6125e-03, PNorm = 34.6889, GNorm = 2.1316, lr_0 = 7.6092e-04
Loss = 4.3241e-03, PNorm = 34.7337, GNorm = 0.8514, lr_0 = 7.4100e-04
Loss = 4.4653e-03, PNorm = 34.7698, GNorm = 0.9392, lr_0 = 7.2160e-04
Validation auc = 0.962157
Epoch 6
Loss = 5.0387e-03, PNorm = 34.8100, GNorm = 3.6341, lr_0 = 7.0085e-04
Loss = 4.1999e-03, PNorm = 34.8440, GNorm = 0.6872, lr_0 = 6.8250e-04
Loss = 4.2031e-03, PNorm = 34.8875, GNorm = 0.6260, lr_0 = 6.6463e-04
Validation auc = 0.965855
Epoch 7
Loss = 3.6698e-03, PNorm = 34.9208, GNorm = 1.7962, lr_0 = 6.4723e-04
Loss = 4.1454e-03, PNorm = 34.9658, GNorm = 0.4610, lr_0 = 6.3029e-04
Loss = 3.7114e-03, PNorm = 34.9971, GNorm = 0.6782, lr_0 = 6.1379e-04
Validation auc = 0.969117
Epoch 8
Loss = 3.6426e-03, PNorm = 35.0315, GNorm = 1.3498, lr_0 = 5.9614e-04
Loss = 3.8443e-03, PNorm = 35.0752, GNorm = 1.7085, lr_0 = 5.8053e-04
Loss = 3.6002e-03, PNorm = 35.1018, GNorm = 0.8242, lr_0 = 5.6533e-04
Validation auc = 0.963680
Epoch 9
Loss = 3.7508e-03, PNorm = 35.1242, GNorm = 2.4240, lr_0 = 5.4907e-04
Loss = 4.0590e-03, PNorm = 35.1486, GNorm = 1.9465, lr_0 = 5.3470e-04
Loss = 4.2979e-03, PNorm = 35.1708, GNorm = 2.1914, lr_0 = 5.2070e-04
Validation auc = 0.969008
Epoch 10
Loss = 3.7021e-03, PNorm = 35.2088, GNorm = 2.1959, lr_0 = 5.0707e-04
Loss = 3.7101e-03, PNorm = 35.2396, GNorm = 0.6518, lr_0 = 4.9380e-04
Loss = 4.1003e-03, PNorm = 35.2574, GNorm = 1.9899, lr_0 = 4.8087e-04
Validation auc = 0.969769
Epoch 11
Loss = 3.5465e-03, PNorm = 35.2843, GNorm = 1.8799, lr_0 = 4.6704e-04
Loss = 3.2744e-03, PNorm = 35.3107, GNorm = 0.8810, lr_0 = 4.5481e-04
Loss = 3.2192e-03, PNorm = 35.3468, GNorm = 1.3331, lr_0 = 4.4291e-04
Validation auc = 0.957808
Epoch 12
Loss = 3.7105e-03, PNorm = 35.3733, GNorm = 1.0756, lr_0 = 4.3017e-04
Loss = 3.2994e-03, PNorm = 35.3991, GNorm = 3.2860, lr_0 = 4.1891e-04
Loss = 3.0484e-03, PNorm = 35.4271, GNorm = 1.0104, lr_0 = 4.0794e-04
Validation auc = 0.968900
Epoch 13
Loss = 2.3150e-03, PNorm = 35.4519, GNorm = 0.8280, lr_0 = 3.9726e-04
Loss = 3.9402e-03, PNorm = 35.4701, GNorm = 2.0932, lr_0 = 3.8686e-04
Loss = 3.6477e-03, PNorm = 35.4910, GNorm = 2.1237, lr_0 = 3.7674e-04
Validation auc = 0.965094
Epoch 14
Loss = 3.0577e-03, PNorm = 35.5221, GNorm = 0.9193, lr_0 = 3.6590e-04
Loss = 2.6861e-03, PNorm = 35.5496, GNorm = 0.5412, lr_0 = 3.5632e-04
Loss = 3.9100e-03, PNorm = 35.5727, GNorm = 0.8005, lr_0 = 3.4699e-04
Validation auc = 0.959874
Epoch 15
Loss = 2.1793e-03, PNorm = 35.5949, GNorm = 1.2643, lr_0 = 3.3702e-04
Loss = 2.8484e-03, PNorm = 35.6270, GNorm = 1.7186, lr_0 = 3.2819e-04
Loss = 3.2017e-03, PNorm = 35.6498, GNorm = 1.4332, lr_0 = 3.1960e-04
Validation auc = 0.966833
Epoch 16
Loss = 2.7156e-03, PNorm = 35.6597, GNorm = 0.8479, lr_0 = 3.1123e-04
Loss = 2.7726e-03, PNorm = 35.6780, GNorm = 1.7667, lr_0 = 3.0309e-04
Loss = 3.5586e-03, PNorm = 35.6938, GNorm = 0.8753, lr_0 = 2.9515e-04
Validation auc = 0.971509
Epoch 17
Loss = 2.5575e-03, PNorm = 35.7203, GNorm = 1.0115, lr_0 = 2.8666e-04
Loss = 2.6096e-03, PNorm = 35.7460, GNorm = 0.7971, lr_0 = 2.7916e-04
Loss = 3.2986e-03, PNorm = 35.7627, GNorm = 1.2958, lr_0 = 2.7185e-04
Validation auc = 0.966507
Epoch 18
Loss = 3.0880e-03, PNorm = 35.7689, GNorm = 0.7174, lr_0 = 2.6403e-04
Loss = 3.0524e-03, PNorm = 35.7859, GNorm = 1.0412, lr_0 = 2.5712e-04
Loss = 2.6021e-03, PNorm = 35.8031, GNorm = 0.7578, lr_0 = 2.5039e-04
Validation auc = 0.968682
Epoch 19
Loss = 2.7064e-03, PNorm = 35.8198, GNorm = 2.8695, lr_0 = 2.4384e-04
Loss = 2.8967e-03, PNorm = 35.8374, GNorm = 0.8957, lr_0 = 2.3745e-04
Loss = 2.7764e-03, PNorm = 35.8529, GNorm = 1.9627, lr_0 = 2.3124e-04
Validation auc = 0.972271
Epoch 20
Loss = 3.5264e-03, PNorm = 35.8690, GNorm = 0.7118, lr_0 = 2.2459e-04
Loss = 2.9472e-03, PNorm = 35.8828, GNorm = 1.9692, lr_0 = 2.1871e-04
Loss = 2.8054e-03, PNorm = 35.8945, GNorm = 1.4638, lr_0 = 2.1298e-04
Validation auc = 0.970422
Epoch 21
Loss = 3.2294e-03, PNorm = 35.9098, GNorm = 0.4652, lr_0 = 2.0686e-04
Loss = 2.4341e-03, PNorm = 35.9199, GNorm = 0.5268, lr_0 = 2.0144e-04
Loss = 2.5609e-03, PNorm = 35.9362, GNorm = 0.9491, lr_0 = 1.9617e-04
Validation auc = 0.969334
Epoch 22
Loss = 3.3183e-03, PNorm = 35.9515, GNorm = 2.0595, lr_0 = 1.9103e-04
Loss = 2.7297e-03, PNorm = 35.9658, GNorm = 0.5765, lr_0 = 1.8603e-04
Loss = 2.4004e-03, PNorm = 35.9763, GNorm = 1.0242, lr_0 = 1.8116e-04
Validation auc = 0.967812
Epoch 23
Loss = 2.4845e-03, PNorm = 35.9882, GNorm = 0.4751, lr_0 = 1.7595e-04
Loss = 2.5594e-03, PNorm = 35.9989, GNorm = 1.0373, lr_0 = 1.7134e-04
Loss = 2.4000e-03, PNorm = 36.0087, GNorm = 0.3956, lr_0 = 1.6686e-04
Validation auc = 0.968900
Epoch 24
Loss = 2.7257e-03, PNorm = 36.0243, GNorm = 1.1137, lr_0 = 1.6206e-04
Loss = 2.0283e-03, PNorm = 36.0353, GNorm = 0.7690, lr_0 = 1.5782e-04
Loss = 2.7157e-03, PNorm = 36.0474, GNorm = 2.0519, lr_0 = 1.5369e-04
Validation auc = 0.963897
Epoch 25
Loss = 1.7158e-03, PNorm = 36.0546, GNorm = 1.3820, lr_0 = 1.4966e-04
Loss = 3.0818e-03, PNorm = 36.0624, GNorm = 1.2417, lr_0 = 1.4575e-04
Loss = 2.2684e-03, PNorm = 36.0719, GNorm = 0.4288, lr_0 = 1.4193e-04
Validation auc = 0.969987
Epoch 26
Loss = 1.5003e-03, PNorm = 36.0817, GNorm = 0.5986, lr_0 = 1.3785e-04
Loss = 2.6582e-03, PNorm = 36.0914, GNorm = 1.0804, lr_0 = 1.3424e-04
Loss = 2.2555e-03, PNorm = 36.0988, GNorm = 0.5805, lr_0 = 1.3073e-04
Validation auc = 0.970966
Epoch 27
Loss = 2.6660e-03, PNorm = 36.1099, GNorm = 0.6848, lr_0 = 1.2697e-04
Loss = 2.5293e-03, PNorm = 36.1197, GNorm = 1.2024, lr_0 = 1.2364e-04
Loss = 2.4680e-03, PNorm = 36.1318, GNorm = 2.2030, lr_0 = 1.2041e-04
Validation auc = 0.968030
Epoch 28
Loss = 2.9953e-03, PNorm = 36.1396, GNorm = 2.4615, lr_0 = 1.1694e-04
Loss = 1.9801e-03, PNorm = 36.1479, GNorm = 1.5037, lr_0 = 1.1388e-04
Loss = 2.6424e-03, PNorm = 36.1536, GNorm = 3.2019, lr_0 = 1.1090e-04
Validation auc = 0.970531
Epoch 29
Loss = 2.5237e-03, PNorm = 36.1600, GNorm = 2.0301, lr_0 = 1.0800e-04
Loss = 1.9535e-03, PNorm = 36.1667, GNorm = 0.5431, lr_0 = 1.0517e-04
Loss = 2.9499e-03, PNorm = 36.1742, GNorm = 0.8026, lr_0 = 1.0242e-04
Validation auc = 0.967486
Model 0 best validation auc = 0.972271 on epoch 19
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test auc = 0.953681
Building model 1
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 354,901
Epoch 0
Loss = 1.2792e-02, PNorm = 34.0436, GNorm = 0.5777, lr_0 = 2.5968e-04
Loss = 1.0311e-02, PNorm = 34.0818, GNorm = 0.5539, lr_0 = 4.0484e-04
Loss = 7.6529e-03, PNorm = 34.1543, GNorm = 1.6313, lr_0 = 5.5000e-04
Loss = 1.7337e-02, PNorm = 34.1624, GNorm = 0.6434, lr_0 = 5.6452e-04
Validation auc = 0.937908
Epoch 1
Loss = 6.9292e-03, PNorm = 34.2249, GNorm = 5.7959, lr_0 = 7.0968e-04
Loss = 7.3291e-03, PNorm = 34.2498, GNorm = 1.6957, lr_0 = 8.5484e-04
Loss = 5.9757e-03, PNorm = 34.2998, GNorm = 0.8874, lr_0 = 1.0000e-03
Loss = 1.5965e-02, PNorm = 34.3066, GNorm = 0.4321, lr_0 = 9.9735e-04
Validation auc = 0.948782
Epoch 2
Loss = 5.3263e-03, PNorm = 34.3598, GNorm = 3.3264, lr_0 = 9.7124e-04
Loss = 5.7959e-03, PNorm = 34.3964, GNorm = 1.5612, lr_0 = 9.4582e-04
Loss = 6.0585e-03, PNorm = 34.4370, GNorm = 0.4259, lr_0 = 9.2106e-04
Loss = 1.9740e-02, PNorm = 34.4394, GNorm = 2.2101, lr_0 = 9.1862e-04
Validation auc = 0.934319
Epoch 3
Loss = 4.8891e-03, PNorm = 34.4760, GNorm = 0.3971, lr_0 = 8.9457e-04
Loss = 5.1506e-03, PNorm = 34.5254, GNorm = 2.6167, lr_0 = 8.7115e-04
Loss = 5.1350e-03, PNorm = 34.5501, GNorm = 0.3205, lr_0 = 8.4834e-04
Validation auc = 0.955089
Epoch 4
Loss = 4.3071e-03, PNorm = 34.5896, GNorm = 1.3175, lr_0 = 8.2613e-04
Loss = 4.1305e-03, PNorm = 34.6394, GNorm = 1.4702, lr_0 = 8.0451e-04
Loss = 5.1609e-03, PNorm = 34.6808, GNorm = 1.9561, lr_0 = 7.8345e-04
Validation auc = 0.966398
Epoch 5
Loss = 4.1970e-03, PNorm = 34.7097, GNorm = 2.8279, lr_0 = 7.6092e-04
Loss = 4.3835e-03, PNorm = 34.7503, GNorm = 1.4546, lr_0 = 7.4100e-04
Loss = 4.7245e-03, PNorm = 34.7827, GNorm = 0.8302, lr_0 = 7.2160e-04
Validation auc = 0.958351
Epoch 6
Loss = 4.1004e-03, PNorm = 34.8276, GNorm = 1.5295, lr_0 = 7.0085e-04
Loss = 3.7915e-03, PNorm = 34.8571, GNorm = 0.7492, lr_0 = 6.8250e-04
Loss = 4.3281e-03, PNorm = 34.8933, GNorm = 1.4588, lr_0 = 6.6463e-04
Validation auc = 0.967486
Epoch 7
Loss = 4.2279e-03, PNorm = 34.9308, GNorm = 1.1825, lr_0 = 6.4723e-04
Loss = 4.0683e-03, PNorm = 34.9604, GNorm = 1.5525, lr_0 = 6.3029e-04
Loss = 3.1836e-03, PNorm = 34.9894, GNorm = 1.0494, lr_0 = 6.1379e-04
Validation auc = 0.965963
Epoch 8
Loss = 3.8753e-03, PNorm = 35.0223, GNorm = 0.5846, lr_0 = 5.9614e-04
Loss = 3.5621e-03, PNorm = 35.0561, GNorm = 2.8382, lr_0 = 5.8053e-04
Loss = 3.8797e-03, PNorm = 35.0861, GNorm = 0.6388, lr_0 = 5.6533e-04
Validation auc = 0.965420
Epoch 9
Loss = 2.6821e-03, PNorm = 35.1100, GNorm = 2.8949, lr_0 = 5.4907e-04
Loss = 4.1197e-03, PNorm = 35.1545, GNorm = 0.7511, lr_0 = 5.3470e-04
Loss = 4.5461e-03, PNorm = 35.1745, GNorm = 2.5083, lr_0 = 5.2070e-04
Validation auc = 0.962810
Epoch 10
Loss = 4.6137e-03, PNorm = 35.1783, GNorm = 1.9939, lr_0 = 5.0707e-04
Loss = 3.4471e-03, PNorm = 35.1931, GNorm = 1.7868, lr_0 = 4.9380e-04
Loss = 3.3037e-03, PNorm = 35.2249, GNorm = 1.1364, lr_0 = 4.8087e-04
Validation auc = 0.958351
Epoch 11
Loss = 4.4169e-03, PNorm = 35.2668, GNorm = 0.7158, lr_0 = 4.6704e-04
Loss = 3.6453e-03, PNorm = 35.2897, GNorm = 1.4434, lr_0 = 4.5481e-04
Loss = 3.8827e-03, PNorm = 35.3069, GNorm = 0.7646, lr_0 = 4.4291e-04
Validation auc = 0.966942
Epoch 12
Loss = 2.4419e-03, PNorm = 35.3212, GNorm = 0.8551, lr_0 = 4.3017e-04
Loss = 4.4497e-03, PNorm = 35.3458, GNorm = 1.8261, lr_0 = 4.1891e-04
Loss = 3.4727e-03, PNorm = 35.3664, GNorm = 1.1172, lr_0 = 4.0794e-04
Validation auc = 0.968791
Epoch 13
Loss = 3.1721e-03, PNorm = 35.3824, GNorm = 1.0659, lr_0 = 3.9726e-04
Loss = 3.3864e-03, PNorm = 35.4022, GNorm = 1.2997, lr_0 = 3.8686e-04
Loss = 3.1358e-03, PNorm = 35.4262, GNorm = 1.2166, lr_0 = 3.7674e-04
Validation auc = 0.964332
Epoch 14
Loss = 4.4257e-03, PNorm = 35.4479, GNorm = 1.9584, lr_0 = 3.6590e-04
Loss = 3.8366e-03, PNorm = 35.4620, GNorm = 1.5704, lr_0 = 3.5632e-04
Loss = 3.3798e-03, PNorm = 35.4821, GNorm = 1.0692, lr_0 = 3.4699e-04
Validation auc = 0.957699
Epoch 15
Loss = 3.1392e-03, PNorm = 35.4996, GNorm = 1.3239, lr_0 = 3.3702e-04
Loss = 3.0907e-03, PNorm = 35.5172, GNorm = 1.5086, lr_0 = 3.2819e-04
Loss = 3.0769e-03, PNorm = 35.5367, GNorm = 0.9381, lr_0 = 3.1960e-04
Validation auc = 0.969008
Epoch 16
Loss = 2.9066e-03, PNorm = 35.5535, GNorm = 1.2786, lr_0 = 3.1123e-04
Loss = 2.3121e-03, PNorm = 35.5738, GNorm = 0.7452, lr_0 = 3.0309e-04
Loss = 3.3982e-03, PNorm = 35.5988, GNorm = 1.4298, lr_0 = 2.9515e-04
Validation auc = 0.964224
Epoch 17
Loss = 3.1624e-03, PNorm = 35.6034, GNorm = 1.1377, lr_0 = 2.8666e-04
Loss = 2.5473e-03, PNorm = 35.6162, GNorm = 0.8340, lr_0 = 2.7916e-04
Loss = 2.9733e-03, PNorm = 35.6350, GNorm = 2.8841, lr_0 = 2.7185e-04
Validation auc = 0.960853
Epoch 18
Loss = 2.8848e-03, PNorm = 35.6550, GNorm = 2.1206, lr_0 = 2.6403e-04
Loss = 2.6062e-03, PNorm = 35.6709, GNorm = 0.4029, lr_0 = 2.5712e-04
Loss = 3.0612e-03, PNorm = 35.6838, GNorm = 0.8577, lr_0 = 2.5039e-04
Validation auc = 0.965094
Epoch 19
Loss = 3.6119e-03, PNorm = 35.7005, GNorm = 1.5039, lr_0 = 2.4384e-04
Loss = 2.7760e-03, PNorm = 35.7152, GNorm = 1.2959, lr_0 = 2.3745e-04
Loss = 2.3944e-03, PNorm = 35.7337, GNorm = 1.6180, lr_0 = 2.3124e-04
Validation auc = 0.965855
Epoch 20
Loss = 1.6880e-03, PNorm = 35.7470, GNorm = 0.5447, lr_0 = 2.2459e-04
Loss = 2.7683e-03, PNorm = 35.7587, GNorm = 1.6346, lr_0 = 2.1871e-04
Loss = 2.9125e-03, PNorm = 35.7716, GNorm = 0.9900, lr_0 = 2.1298e-04
Validation auc = 0.967051
Epoch 21
Loss = 2.8114e-03, PNorm = 35.7842, GNorm = 1.7711, lr_0 = 2.0686e-04
Loss = 2.7242e-03, PNorm = 35.8022, GNorm = 2.6462, lr_0 = 2.0144e-04
Loss = 2.3138e-03, PNorm = 35.8173, GNorm = 0.7588, lr_0 = 1.9617e-04
Validation auc = 0.966616
Epoch 22
Loss = 2.2570e-03, PNorm = 35.8258, GNorm = 0.6866, lr_0 = 1.9103e-04
Loss = 2.5522e-03, PNorm = 35.8371, GNorm = 0.4640, lr_0 = 1.8603e-04
Loss = 2.0190e-03, PNorm = 35.8525, GNorm = 2.8459, lr_0 = 1.8116e-04
Validation auc = 0.965637
Epoch 23
Loss = 2.4376e-03, PNorm = 35.8651, GNorm = 0.7548, lr_0 = 1.7595e-04
Loss = 2.3235e-03, PNorm = 35.8753, GNorm = 1.7029, lr_0 = 1.7134e-04
Loss = 2.1891e-03, PNorm = 35.8856, GNorm = 0.8844, lr_0 = 1.6686e-04
Validation auc = 0.965746
Epoch 24
Loss = 1.8198e-03, PNorm = 35.8954, GNorm = 1.1406, lr_0 = 1.6206e-04
Loss = 2.2472e-03, PNorm = 35.9103, GNorm = 1.5889, lr_0 = 1.5782e-04
Loss = 2.7759e-03, PNorm = 35.9196, GNorm = 1.2442, lr_0 = 1.5369e-04
Validation auc = 0.964332
Epoch 25
Loss = 2.1816e-03, PNorm = 35.9295, GNorm = 1.6072, lr_0 = 1.4966e-04
Loss = 2.3884e-03, PNorm = 35.9404, GNorm = 1.0439, lr_0 = 1.4575e-04
Loss = 2.5907e-03, PNorm = 35.9477, GNorm = 1.1512, lr_0 = 1.4193e-04
Validation auc = 0.969878
Epoch 26
Loss = 2.7681e-03, PNorm = 35.9572, GNorm = 0.9182, lr_0 = 1.3785e-04
Loss = 2.0960e-03, PNorm = 35.9685, GNorm = 1.8699, lr_0 = 1.3424e-04
Loss = 2.7515e-03, PNorm = 35.9766, GNorm = 1.6023, lr_0 = 1.3073e-04
Validation auc = 0.968247
Epoch 27
Loss = 1.5371e-03, PNorm = 35.9838, GNorm = 0.8023, lr_0 = 1.2697e-04
Loss = 1.7099e-03, PNorm = 35.9909, GNorm = 1.1091, lr_0 = 1.2364e-04
Loss = 2.6907e-03, PNorm = 35.9993, GNorm = 0.8548, lr_0 = 1.2041e-04
Validation auc = 0.966398
Epoch 28
Loss = 2.0229e-03, PNorm = 36.0074, GNorm = 0.5849, lr_0 = 1.1694e-04
Loss = 2.3011e-03, PNorm = 36.0166, GNorm = 0.6269, lr_0 = 1.1388e-04
Loss = 2.2387e-03, PNorm = 36.0244, GNorm = 1.1886, lr_0 = 1.1090e-04
Validation auc = 0.965094
Epoch 29
Loss = 3.3136e-03, PNorm = 36.0310, GNorm = 1.1315, lr_0 = 1.0800e-04
Loss = 2.2507e-03, PNorm = 36.0383, GNorm = 1.1382, lr_0 = 1.0517e-04
Loss = 2.4580e-03, PNorm = 36.0457, GNorm = 1.4196, lr_0 = 1.0242e-04
Validation auc = 0.964985
Model 1 best validation auc = 0.969878 on epoch 25
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 1 test auc = 0.953267
Building model 2
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 354,901
Epoch 0
Loss = 1.2934e-02, PNorm = 34.0166, GNorm = 0.5886, lr_0 = 2.5968e-04
Loss = 1.0517e-02, PNorm = 34.0554, GNorm = 0.4154, lr_0 = 4.0484e-04
Loss = 7.5613e-03, PNorm = 34.1334, GNorm = 0.8843, lr_0 = 5.5000e-04
Loss = 2.3945e-02, PNorm = 34.1428, GNorm = 0.7377, lr_0 = 5.6452e-04
Validation auc = 0.950848
Epoch 1
Loss = 6.5039e-03, PNorm = 34.2072, GNorm = 2.1662, lr_0 = 7.0968e-04
Loss = 4.9557e-03, PNorm = 34.2569, GNorm = 1.5346, lr_0 = 8.5484e-04
Loss = 5.9886e-03, PNorm = 34.2782, GNorm = 4.0375, lr_0 = 1.0000e-03
Loss = 4.3405e-03, PNorm = 34.2822, GNorm = 0.8492, lr_0 = 9.9735e-04
Validation auc = 0.956503
Epoch 2
Loss = 5.4148e-03, PNorm = 34.3221, GNorm = 0.6472, lr_0 = 9.7124e-04
Loss = 5.4302e-03, PNorm = 34.3566, GNorm = 3.7914, lr_0 = 9.4582e-04
Loss = 5.6578e-03, PNorm = 34.3769, GNorm = 3.0013, lr_0 = 9.2106e-04
Loss = 1.1664e-02, PNorm = 34.3800, GNorm = 0.9772, lr_0 = 9.1862e-04
Validation auc = 0.950087
Epoch 3
Loss = 4.9522e-03, PNorm = 34.4211, GNorm = 0.7159, lr_0 = 8.9457e-04
Loss = 4.8095e-03, PNorm = 34.4651, GNorm = 0.6440, lr_0 = 8.7115e-04
Loss = 3.5213e-03, PNorm = 34.5049, GNorm = 0.7006, lr_0 = 8.4834e-04
Validation auc = 0.957047
Epoch 4
Loss = 4.4231e-03, PNorm = 34.5350, GNorm = 1.1918, lr_0 = 8.2613e-04
Loss = 5.2698e-03, PNorm = 34.5508, GNorm = 3.2791, lr_0 = 8.0451e-04
Loss = 4.4838e-03, PNorm = 34.5826, GNorm = 2.0806, lr_0 = 7.8345e-04
Validation auc = 0.961396
Epoch 5
Loss = 4.2553e-03, PNorm = 34.6265, GNorm = 1.7103, lr_0 = 7.6092e-04
Loss = 3.6302e-03, PNorm = 34.6811, GNorm = 0.9572, lr_0 = 7.4100e-04
Loss = 4.7452e-03, PNorm = 34.7085, GNorm = 2.1380, lr_0 = 7.2160e-04
Validation auc = 0.970639
Epoch 6
Loss = 4.0335e-03, PNorm = 34.7332, GNorm = 1.2145, lr_0 = 7.0085e-04
Loss = 3.7163e-03, PNorm = 34.7640, GNorm = 3.0253, lr_0 = 6.8250e-04
Loss = 4.5834e-03, PNorm = 34.8042, GNorm = 1.3969, lr_0 = 6.6463e-04
Validation auc = 0.958134
Epoch 7
Loss = 4.3924e-03, PNorm = 34.8334, GNorm = 0.8099, lr_0 = 6.4723e-04
Loss = 3.4609e-03, PNorm = 34.8689, GNorm = 1.7621, lr_0 = 6.3029e-04
Loss = 4.0172e-03, PNorm = 34.9096, GNorm = 2.1742, lr_0 = 6.1379e-04
Validation auc = 0.963245
Epoch 8
Loss = 4.7093e-03, PNorm = 34.9224, GNorm = 2.8393, lr_0 = 5.9614e-04
Loss = 3.6122e-03, PNorm = 34.9473, GNorm = 1.4886, lr_0 = 5.8053e-04
Loss = 3.6129e-03, PNorm = 34.9910, GNorm = 1.8858, lr_0 = 5.6533e-04
Validation auc = 0.971509
Epoch 9
Loss = 2.7499e-03, PNorm = 35.0370, GNorm = 0.8772, lr_0 = 5.4907e-04
Loss = 3.7759e-03, PNorm = 35.0676, GNorm = 1.6548, lr_0 = 5.3470e-04
Loss = 3.5340e-03, PNorm = 35.0892, GNorm = 0.9947, lr_0 = 5.2070e-04
Validation auc = 0.970966
Epoch 10
Loss = 3.6507e-03, PNorm = 35.1161, GNorm = 1.9085, lr_0 = 5.0707e-04
Loss = 3.2314e-03, PNorm = 35.1402, GNorm = 1.2559, lr_0 = 4.9380e-04
Loss = 3.7520e-03, PNorm = 35.1610, GNorm = 2.2441, lr_0 = 4.8087e-04
Validation auc = 0.970204
Epoch 11
Loss = 3.1414e-03, PNorm = 35.1877, GNorm = 1.0536, lr_0 = 4.6704e-04
Loss = 3.7658e-03, PNorm = 35.2142, GNorm = 1.2415, lr_0 = 4.5481e-04
Loss = 3.1458e-03, PNorm = 35.2402, GNorm = 0.5688, lr_0 = 4.4291e-04
Validation auc = 0.971509
Epoch 12
Loss = 3.6412e-03, PNorm = 35.2715, GNorm = 0.8527, lr_0 = 4.3017e-04
Loss = 3.5865e-03, PNorm = 35.2894, GNorm = 0.4387, lr_0 = 4.1891e-04
Loss = 2.4850e-03, PNorm = 35.3133, GNorm = 2.0683, lr_0 = 4.0794e-04
Validation auc = 0.974663
Epoch 13
Loss = 3.2041e-03, PNorm = 35.3299, GNorm = 1.7565, lr_0 = 3.9726e-04
Loss = 3.3630e-03, PNorm = 35.3527, GNorm = 0.9883, lr_0 = 3.8686e-04
Loss = 2.7875e-03, PNorm = 35.3776, GNorm = 0.5579, lr_0 = 3.7674e-04
Validation auc = 0.969987
Epoch 14
Loss = 3.5834e-03, PNorm = 35.3935, GNorm = 2.5087, lr_0 = 3.6590e-04
Loss = 3.0222e-03, PNorm = 35.4082, GNorm = 2.0798, lr_0 = 3.5632e-04
Loss = 3.0123e-03, PNorm = 35.4290, GNorm = 1.6891, lr_0 = 3.4699e-04
Validation auc = 0.957808
Epoch 15
Loss = 3.6332e-03, PNorm = 35.4516, GNorm = 0.9747, lr_0 = 3.3702e-04
Loss = 2.8190e-03, PNorm = 35.4775, GNorm = 0.4621, lr_0 = 3.2819e-04
Loss = 2.7919e-03, PNorm = 35.5026, GNorm = 2.5340, lr_0 = 3.1960e-04
Validation auc = 0.966507
Epoch 16
Loss = 2.4026e-03, PNorm = 35.5182, GNorm = 1.3553, lr_0 = 3.1123e-04
Loss = 3.5120e-03, PNorm = 35.5313, GNorm = 0.5482, lr_0 = 3.0309e-04
Loss = 2.8252e-03, PNorm = 35.5515, GNorm = 4.0658, lr_0 = 2.9515e-04
Validation auc = 0.970204
Epoch 17
Loss = 2.6183e-03, PNorm = 35.5770, GNorm = 0.6826, lr_0 = 2.8666e-04
Loss = 2.4528e-03, PNorm = 35.5987, GNorm = 0.7934, lr_0 = 2.7916e-04
Loss = 2.8101e-03, PNorm = 35.6115, GNorm = 0.7710, lr_0 = 2.7185e-04
Validation auc = 0.970639
Epoch 18
Loss = 2.1387e-03, PNorm = 35.6198, GNorm = 0.9414, lr_0 = 2.6403e-04
Loss = 2.9187e-03, PNorm = 35.6363, GNorm = 1.8828, lr_0 = 2.5712e-04
Loss = 2.6930e-03, PNorm = 35.6474, GNorm = 0.8889, lr_0 = 2.5039e-04
Validation auc = 0.970857
Epoch 19
Loss = 3.4678e-03, PNorm = 35.6679, GNorm = 0.6434, lr_0 = 2.4384e-04
Loss = 3.2786e-03, PNorm = 35.6791, GNorm = 0.5009, lr_0 = 2.3745e-04
Loss = 3.1757e-03, PNorm = 35.6871, GNorm = 2.0769, lr_0 = 2.3124e-04
Validation auc = 0.970639
Epoch 20
Loss = 2.5828e-03, PNorm = 35.7037, GNorm = 0.5947, lr_0 = 2.2459e-04
Loss = 2.6501e-03, PNorm = 35.7165, GNorm = 2.1040, lr_0 = 2.1871e-04
Loss = 2.2446e-03, PNorm = 35.7311, GNorm = 5.0188, lr_0 = 2.1298e-04
Validation auc = 0.971509
Epoch 21
Loss = 2.5359e-03, PNorm = 35.7437, GNorm = 1.9008, lr_0 = 2.0686e-04
Loss = 2.4898e-03, PNorm = 35.7541, GNorm = 1.7919, lr_0 = 2.0144e-04
Loss = 3.5492e-03, PNorm = 35.7659, GNorm = 1.9993, lr_0 = 1.9617e-04
Validation auc = 0.967921
Epoch 22
Loss = 1.9479e-03, PNorm = 35.7736, GNorm = 1.8110, lr_0 = 1.9103e-04
Loss = 2.1694e-03, PNorm = 35.7869, GNorm = 0.7869, lr_0 = 1.8603e-04
Loss = 2.8590e-03, PNorm = 35.8001, GNorm = 1.2516, lr_0 = 1.8116e-04
Validation auc = 0.971509
Epoch 23
Loss = 1.7290e-03, PNorm = 35.8096, GNorm = 0.8481, lr_0 = 1.7595e-04
Loss = 2.7048e-03, PNorm = 35.8178, GNorm = 1.9009, lr_0 = 1.7134e-04
Loss = 3.0603e-03, PNorm = 35.8295, GNorm = 5.7156, lr_0 = 1.6686e-04
Validation auc = 0.969117
Epoch 24
Loss = 1.6333e-03, PNorm = 35.8382, GNorm = 0.4738, lr_0 = 1.6206e-04
Loss = 2.4263e-03, PNorm = 35.8478, GNorm = 1.4597, lr_0 = 1.5782e-04
Loss = 2.5474e-03, PNorm = 35.8607, GNorm = 0.7363, lr_0 = 1.5369e-04
Validation auc = 0.973249
Epoch 25
Loss = 1.6687e-03, PNorm = 35.8680, GNorm = 0.4040, lr_0 = 1.4966e-04
Loss = 2.9870e-03, PNorm = 35.8759, GNorm = 1.0270, lr_0 = 1.4575e-04
Loss = 2.4379e-03, PNorm = 35.8873, GNorm = 0.3718, lr_0 = 1.4193e-04
Validation auc = 0.964115
Epoch 26
Loss = 4.0045e-03, PNorm = 35.9012, GNorm = 1.4267, lr_0 = 1.3785e-04
Loss = 2.4531e-03, PNorm = 35.9105, GNorm = 2.5714, lr_0 = 1.3424e-04
Loss = 2.2338e-03, PNorm = 35.9194, GNorm = 0.3902, lr_0 = 1.3073e-04
Validation auc = 0.971292
Epoch 27
Loss = 2.2025e-03, PNorm = 35.9281, GNorm = 3.0133, lr_0 = 1.2697e-04
Loss = 2.3388e-03, PNorm = 35.9351, GNorm = 1.9110, lr_0 = 1.2364e-04
Loss = 2.4141e-03, PNorm = 35.9426, GNorm = 0.7499, lr_0 = 1.2041e-04
Validation auc = 0.974554
Epoch 28
Loss = 2.5223e-03, PNorm = 35.9520, GNorm = 0.9082, lr_0 = 1.1694e-04
Loss = 2.3446e-03, PNorm = 35.9568, GNorm = 3.7407, lr_0 = 1.1388e-04
Loss = 2.0091e-03, PNorm = 35.9650, GNorm = 0.8767, lr_0 = 1.1090e-04
Validation auc = 0.970422
Epoch 29
Loss = 1.3820e-03, PNorm = 35.9714, GNorm = 0.7443, lr_0 = 1.0800e-04
Loss = 2.0253e-03, PNorm = 35.9797, GNorm = 0.6326, lr_0 = 1.0517e-04
Loss = 2.3470e-03, PNorm = 35.9882, GNorm = 2.3214, lr_0 = 1.0242e-04
Validation auc = 0.968465
Model 2 best validation auc = 0.974663 on epoch 12
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 2 test auc = 0.946650
Building model 3
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 354,901
Epoch 0
Loss = 1.2930e-02, PNorm = 33.9924, GNorm = 0.4885, lr_0 = 2.5968e-04
Loss = 1.0553e-02, PNorm = 34.0309, GNorm = 0.4367, lr_0 = 4.0484e-04
Loss = 7.5463e-03, PNorm = 34.1120, GNorm = 0.3880, lr_0 = 5.5000e-04
Loss = 2.0116e-02, PNorm = 34.1206, GNorm = 2.8415, lr_0 = 5.6452e-04
Validation auc = 0.942692
Epoch 1
Loss = 5.7250e-03, PNorm = 34.1911, GNorm = 1.6604, lr_0 = 7.0968e-04
Loss = 6.8240e-03, PNorm = 34.2101, GNorm = 2.4911, lr_0 = 8.5484e-04
Loss = 6.4018e-03, PNorm = 34.2327, GNorm = 0.7763, lr_0 = 1.0000e-03
Loss = 1.1385e-02, PNorm = 34.2362, GNorm = 1.0178, lr_0 = 9.9735e-04
Validation auc = 0.937364
Epoch 2
Loss = 5.1094e-03, PNorm = 34.2901, GNorm = 1.3516, lr_0 = 9.7124e-04
Loss = 5.4004e-03, PNorm = 34.3330, GNorm = 0.4915, lr_0 = 9.4582e-04
Loss = 5.0898e-03, PNorm = 34.3599, GNorm = 0.8179, lr_0 = 9.2106e-04
Loss = 1.9634e-02, PNorm = 34.3618, GNorm = 5.0132, lr_0 = 9.1862e-04
Validation auc = 0.958895
Epoch 3
Loss = 4.6444e-03, PNorm = 34.3972, GNorm = 0.6675, lr_0 = 8.9457e-04
Loss = 4.8107e-03, PNorm = 34.4335, GNorm = 1.1396, lr_0 = 8.7115e-04
Loss = 4.9759e-03, PNorm = 34.4579, GNorm = 0.5927, lr_0 = 8.4834e-04
Validation auc = 0.959439
Epoch 4
Loss = 3.8410e-03, PNorm = 34.5069, GNorm = 1.1185, lr_0 = 8.2613e-04
Loss = 4.5697e-03, PNorm = 34.5578, GNorm = 0.8153, lr_0 = 8.0451e-04
Loss = 4.5244e-03, PNorm = 34.5882, GNorm = 3.0713, lr_0 = 7.8345e-04
Validation auc = 0.961722
Epoch 5
Loss = 4.3593e-03, PNorm = 34.6239, GNorm = 3.1660, lr_0 = 7.6092e-04
Loss = 4.1823e-03, PNorm = 34.6582, GNorm = 5.5300, lr_0 = 7.4100e-04
Loss = 4.4404e-03, PNorm = 34.6894, GNorm = 3.0968, lr_0 = 7.2160e-04
Validation auc = 0.964441
Epoch 6
Loss = 4.2303e-03, PNorm = 34.7343, GNorm = 1.2898, lr_0 = 7.0085e-04
Loss = 4.0560e-03, PNorm = 34.7654, GNorm = 0.6232, lr_0 = 6.8250e-04
Loss = 3.6908e-03, PNorm = 34.7931, GNorm = 0.8248, lr_0 = 6.6463e-04
Validation auc = 0.968791
Epoch 7
Loss = 4.1093e-03, PNorm = 34.8316, GNorm = 1.4581, lr_0 = 6.4723e-04
Loss = 3.6826e-03, PNorm = 34.8668, GNorm = 1.5620, lr_0 = 6.3029e-04
Loss = 4.1303e-03, PNorm = 34.8870, GNorm = 1.1644, lr_0 = 6.1379e-04
Validation auc = 0.964550
Epoch 8
Loss = 4.1250e-03, PNorm = 34.9105, GNorm = 0.8632, lr_0 = 5.9614e-04
Loss = 3.9775e-03, PNorm = 34.9393, GNorm = 3.8641, lr_0 = 5.8053e-04
Loss = 3.6236e-03, PNorm = 34.9763, GNorm = 3.5106, lr_0 = 5.6533e-04
Validation auc = 0.962810
Epoch 9
Loss = 4.4307e-03, PNorm = 34.9910, GNorm = 3.3723, lr_0 = 5.4907e-04
Loss = 3.4005e-03, PNorm = 35.0105, GNorm = 1.8066, lr_0 = 5.3470e-04
Loss = 3.9838e-03, PNorm = 35.0431, GNorm = 1.7477, lr_0 = 5.2070e-04
Validation auc = 0.965420
Epoch 10
Loss = 4.4418e-03, PNorm = 35.0675, GNorm = 1.1236, lr_0 = 5.0707e-04
Loss = 3.5549e-03, PNorm = 35.0973, GNorm = 0.7955, lr_0 = 4.9380e-04
Loss = 3.0605e-03, PNorm = 35.1319, GNorm = 0.5815, lr_0 = 4.8087e-04
Validation auc = 0.964550
Epoch 11
Loss = 2.6168e-03, PNorm = 35.1602, GNorm = 0.7234, lr_0 = 4.6704e-04
Loss = 2.9858e-03, PNorm = 35.1805, GNorm = 3.6271, lr_0 = 4.5481e-04
Loss = 3.7131e-03, PNorm = 35.1966, GNorm = 0.6743, lr_0 = 4.4291e-04
Validation auc = 0.959330
Epoch 12
Loss = 3.5227e-03, PNorm = 35.2235, GNorm = 1.6325, lr_0 = 4.3017e-04
Loss = 3.3940e-03, PNorm = 35.2456, GNorm = 2.0738, lr_0 = 4.1891e-04
Loss = 3.7398e-03, PNorm = 35.2578, GNorm = 1.4878, lr_0 = 4.0794e-04
Validation auc = 0.967921
Epoch 13
Loss = 2.8980e-03, PNorm = 35.2753, GNorm = 1.4833, lr_0 = 3.9726e-04
Loss = 2.4870e-03, PNorm = 35.2956, GNorm = 0.8396, lr_0 = 3.8686e-04
Loss = 3.5447e-03, PNorm = 35.3257, GNorm = 2.0265, lr_0 = 3.7674e-04
Validation auc = 0.974228
Epoch 14
Loss = 3.8795e-03, PNorm = 35.3448, GNorm = 1.5850, lr_0 = 3.6590e-04
Loss = 3.3485e-03, PNorm = 35.3582, GNorm = 2.9964, lr_0 = 3.5632e-04
Loss = 3.6845e-03, PNorm = 35.3856, GNorm = 2.0355, lr_0 = 3.4699e-04
Validation auc = 0.967921
Epoch 15
Loss = 2.7198e-03, PNorm = 35.4182, GNorm = 0.6852, lr_0 = 3.3702e-04
Loss = 2.8675e-03, PNorm = 35.4411, GNorm = 1.6982, lr_0 = 3.2819e-04
Loss = 3.6999e-03, PNorm = 35.4566, GNorm = 0.5724, lr_0 = 3.1960e-04
Validation auc = 0.966616
Epoch 16
Loss = 2.4040e-03, PNorm = 35.4775, GNorm = 0.8780, lr_0 = 3.1123e-04
Loss = 2.4149e-03, PNorm = 35.5006, GNorm = 0.7877, lr_0 = 3.0309e-04
Loss = 3.6672e-03, PNorm = 35.5164, GNorm = 0.9048, lr_0 = 2.9515e-04
Validation auc = 0.969769
Epoch 17
Loss = 2.9727e-03, PNorm = 35.5394, GNorm = 1.5627, lr_0 = 2.8666e-04
Loss = 2.6623e-03, PNorm = 35.5528, GNorm = 0.5764, lr_0 = 2.7916e-04
Loss = 2.8791e-03, PNorm = 35.5693, GNorm = 3.5826, lr_0 = 2.7185e-04
Validation auc = 0.966398
Epoch 18
Loss = 2.1419e-03, PNorm = 35.5897, GNorm = 1.5479, lr_0 = 2.6403e-04
Loss = 2.8127e-03, PNorm = 35.6094, GNorm = 1.1409, lr_0 = 2.5712e-04
Loss = 2.8889e-03, PNorm = 35.6286, GNorm = 0.9825, lr_0 = 2.5039e-04
Validation auc = 0.969008
Epoch 19
Loss = 2.7089e-03, PNorm = 35.6454, GNorm = 0.8829, lr_0 = 2.4384e-04
Loss = 3.0814e-03, PNorm = 35.6601, GNorm = 1.9772, lr_0 = 2.3745e-04
Loss = 2.4507e-03, PNorm = 35.6747, GNorm = 0.5912, lr_0 = 2.3124e-04
Validation auc = 0.968138
Epoch 20
Loss = 2.5446e-03, PNorm = 35.6901, GNorm = 2.1291, lr_0 = 2.2459e-04
Loss = 2.5772e-03, PNorm = 35.7000, GNorm = 0.8146, lr_0 = 2.1871e-04
Loss = 2.9149e-03, PNorm = 35.7144, GNorm = 0.5608, lr_0 = 2.1298e-04
Validation auc = 0.968247
Epoch 21
Loss = 1.8731e-03, PNorm = 35.7313, GNorm = 1.1773, lr_0 = 2.0686e-04
Loss = 3.0057e-03, PNorm = 35.7471, GNorm = 1.0852, lr_0 = 2.0144e-04
Loss = 2.4917e-03, PNorm = 35.7640, GNorm = 0.8078, lr_0 = 1.9617e-04
Validation auc = 0.969117
Epoch 22
Loss = 2.0940e-03, PNorm = 35.7707, GNorm = 1.2667, lr_0 = 1.9103e-04
Loss = 3.2062e-03, PNorm = 35.7771, GNorm = 1.0691, lr_0 = 1.8603e-04
Loss = 2.5930e-03, PNorm = 35.7927, GNorm = 0.7996, lr_0 = 1.8116e-04
Validation auc = 0.971836
Epoch 23
Loss = 2.6471e-03, PNorm = 35.8106, GNorm = 1.0194, lr_0 = 1.7595e-04
Loss = 2.3158e-03, PNorm = 35.8253, GNorm = 1.6212, lr_0 = 1.7134e-04
Loss = 2.9631e-03, PNorm = 35.8344, GNorm = 1.0084, lr_0 = 1.6686e-04
Validation auc = 0.968356
Epoch 24
Loss = 3.3403e-03, PNorm = 35.8442, GNorm = 2.2756, lr_0 = 1.6206e-04
Loss = 2.6635e-03, PNorm = 35.8544, GNorm = 3.5126, lr_0 = 1.5782e-04
Loss = 1.8978e-03, PNorm = 35.8649, GNorm = 1.2143, lr_0 = 1.5369e-04
Validation auc = 0.967377
Epoch 25
Loss = 1.4617e-03, PNorm = 35.8759, GNorm = 0.4982, lr_0 = 1.4966e-04
Loss = 2.2660e-03, PNorm = 35.8905, GNorm = 1.5791, lr_0 = 1.4575e-04
Loss = 2.3499e-03, PNorm = 35.9022, GNorm = 1.0293, lr_0 = 1.4193e-04
Validation auc = 0.965746
Epoch 26
Loss = 2.2191e-03, PNorm = 35.9085, GNorm = 2.0048, lr_0 = 1.3785e-04
Loss = 2.4766e-03, PNorm = 35.9143, GNorm = 1.0429, lr_0 = 1.3424e-04
Loss = 1.7859e-03, PNorm = 35.9234, GNorm = 0.7774, lr_0 = 1.3073e-04
Validation auc = 0.968573
Epoch 27
Loss = 3.1800e-03, PNorm = 35.9372, GNorm = 2.8009, lr_0 = 1.2697e-04
Loss = 2.0699e-03, PNorm = 35.9459, GNorm = 0.3669, lr_0 = 1.2364e-04
Loss = 2.3304e-03, PNorm = 35.9549, GNorm = 0.9181, lr_0 = 1.2041e-04
Validation auc = 0.968030
Epoch 28
Loss = 1.3913e-03, PNorm = 35.9628, GNorm = 0.7410, lr_0 = 1.1694e-04
Loss = 2.4293e-03, PNorm = 35.9716, GNorm = 0.8223, lr_0 = 1.1388e-04
Loss = 2.3295e-03, PNorm = 35.9780, GNorm = 1.1099, lr_0 = 1.1090e-04
Validation auc = 0.968356
Epoch 29
Loss = 1.0859e-03, PNorm = 35.9877, GNorm = 0.5900, lr_0 = 1.0800e-04
Loss = 2.1108e-03, PNorm = 35.9933, GNorm = 0.8078, lr_0 = 1.0517e-04
Loss = 2.0703e-03, PNorm = 36.0005, GNorm = 2.1131, lr_0 = 1.0242e-04
Validation auc = 0.964115
Model 3 best validation auc = 0.974228 on epoch 13
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 3 test auc = 0.952233
Ensemble test auc = 0.952957
Fold 1
Command line
python train.py --data_path ./App2/ligands2.csv --save_dir ./App2/limited_1971_balanced_cv2_en4 --dataset_type classification --class_balance --num_folds 2 --ensemble_size 4
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': True,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': './App2/ligands2.csv',
 'dataset_type': 'classification',
 'depth': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'ensemble_size': 4,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'auc',
 'minimize_score': False,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 2,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': './App2/limited_1971_balanced_cv2_en4\\fold_1',
 'save_smiles_splits': False,
 'seed': 1,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['activity'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1576,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 1
Class sizes
activity 0: 47.06%, 1: 52.94%
Total size = 1,970 | train size = 1,576 | val size = 197 | test size = 197
With class_balance, effective train size = 1,470
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 354,901
Epoch 0
Loss = 1.2834e-02, PNorm = 34.0194, GNorm = 0.3686, lr_0 = 2.5968e-04
Loss = 1.0592e-02, PNorm = 34.0627, GNorm = 0.6316, lr_0 = 4.0484e-04
Validation auc = 0.913626
Epoch 1
Loss = 6.5311e-03, PNorm = 34.1665, GNorm = 1.9785, lr_0 = 5.6452e-04
Loss = 6.1698e-03, PNorm = 34.2319, GNorm = 1.8497, lr_0 = 7.0968e-04
Loss = 5.6385e-03, PNorm = 34.2607, GNorm = 2.7063, lr_0 = 8.5484e-04
Validation auc = 0.919295
Epoch 2
Loss = 8.1773e-03, PNorm = 34.2896, GNorm = 3.9271, lr_0 = 9.9735e-04
Loss = 6.1357e-03, PNorm = 34.3304, GNorm = 0.3666, lr_0 = 9.7124e-04
Loss = 5.7741e-03, PNorm = 34.3635, GNorm = 1.2829, lr_0 = 9.4582e-04
Validation auc = 0.937951
Epoch 3
Loss = 6.6886e-03, PNorm = 34.3995, GNorm = 0.9400, lr_0 = 9.2106e-04
Loss = 4.6225e-03, PNorm = 34.4428, GNorm = 0.8757, lr_0 = 8.9694e-04
Loss = 5.2626e-03, PNorm = 34.4756, GNorm = 2.7020, lr_0 = 8.7346e-04
Validation auc = 0.939188
Epoch 4
Loss = 5.3163e-03, PNorm = 34.5121, GNorm = 3.1561, lr_0 = 8.4834e-04
Loss = 4.6820e-03, PNorm = 34.5352, GNorm = 1.0180, lr_0 = 8.2613e-04
Loss = 3.9834e-03, PNorm = 34.5675, GNorm = 0.4204, lr_0 = 8.0451e-04
Validation auc = 0.940425
Epoch 5
Loss = 4.8876e-03, PNorm = 34.5880, GNorm = 1.3127, lr_0 = 7.8345e-04
Loss = 4.4774e-03, PNorm = 34.6230, GNorm = 1.4676, lr_0 = 7.6294e-04
Loss = 4.6194e-03, PNorm = 34.6619, GNorm = 1.1358, lr_0 = 7.4296e-04
Validation auc = 0.944960
Epoch 6
Loss = 4.5052e-03, PNorm = 34.6927, GNorm = 2.9543, lr_0 = 7.2160e-04
Loss = 4.1058e-03, PNorm = 34.7172, GNorm = 1.1156, lr_0 = 7.0271e-04
Loss = 4.0636e-03, PNorm = 34.7463, GNorm = 0.7259, lr_0 = 6.8431e-04
Validation auc = 0.949392
Epoch 7
Loss = 4.2103e-03, PNorm = 34.7790, GNorm = 0.9430, lr_0 = 6.6463e-04
Loss = 4.9956e-03, PNorm = 34.8008, GNorm = 2.6077, lr_0 = 6.4723e-04
Loss = 3.2926e-03, PNorm = 34.8405, GNorm = 1.8792, lr_0 = 6.3029e-04
Validation auc = 0.950629
Epoch 8
Loss = 4.7896e-03, PNorm = 34.8768, GNorm = 0.5062, lr_0 = 6.1379e-04
Loss = 3.7506e-03, PNorm = 34.9057, GNorm = 1.3248, lr_0 = 5.9772e-04
Loss = 4.6589e-03, PNorm = 34.9314, GNorm = 0.9260, lr_0 = 5.8207e-04
Validation auc = 0.953309
Epoch 9
Loss = 3.7978e-03, PNorm = 34.9677, GNorm = 3.7106, lr_0 = 5.6533e-04
Loss = 4.3045e-03, PNorm = 34.9979, GNorm = 5.8425, lr_0 = 5.5053e-04
Loss = 4.9787e-03, PNorm = 35.0119, GNorm = 2.0876, lr_0 = 5.3612e-04
Validation auc = 0.949804
Epoch 10
Loss = 3.5499e-03, PNorm = 35.0383, GNorm = 0.5497, lr_0 = 5.2209e-04
Loss = 3.6533e-03, PNorm = 35.0710, GNorm = 0.5341, lr_0 = 5.0842e-04
Loss = 3.6169e-03, PNorm = 35.0983, GNorm = 1.5203, lr_0 = 4.9511e-04
Validation auc = 0.946918
Epoch 11
Loss = 4.0294e-03, PNorm = 35.1199, GNorm = 0.4217, lr_0 = 4.8087e-04
Loss = 3.7637e-03, PNorm = 35.1412, GNorm = 0.7739, lr_0 = 4.6828e-04
Loss = 3.4086e-03, PNorm = 35.1782, GNorm = 1.2109, lr_0 = 4.5602e-04
Validation auc = 0.950732
Epoch 12
Loss = 3.8433e-03, PNorm = 35.2038, GNorm = 1.2522, lr_0 = 4.4291e-04
Loss = 3.7862e-03, PNorm = 35.2222, GNorm = 1.3229, lr_0 = 4.3131e-04
Loss = 3.1918e-03, PNorm = 35.2497, GNorm = 1.5980, lr_0 = 4.2002e-04
Validation auc = 0.961245
Epoch 13
Loss = 3.1937e-03, PNorm = 35.2764, GNorm = 1.5030, lr_0 = 4.0903e-04
Loss = 3.3239e-03, PNorm = 35.3002, GNorm = 1.8763, lr_0 = 3.9832e-04
Loss = 3.6052e-03, PNorm = 35.3249, GNorm = 0.9308, lr_0 = 3.8789e-04
Validation auc = 0.960730
Epoch 14
Loss = 3.5090e-03, PNorm = 35.3528, GNorm = 0.5711, lr_0 = 3.7674e-04
Loss = 3.3699e-03, PNorm = 35.3787, GNorm = 1.4957, lr_0 = 3.6687e-04
Loss = 3.1872e-03, PNorm = 35.3993, GNorm = 0.4115, lr_0 = 3.5727e-04
Validation auc = 0.959699
Epoch 15
Loss = 3.5295e-03, PNorm = 35.4229, GNorm = 1.4722, lr_0 = 3.4792e-04
Loss = 2.9837e-03, PNorm = 35.4494, GNorm = 3.4538, lr_0 = 3.3881e-04
Loss = 3.4670e-03, PNorm = 35.4709, GNorm = 2.7855, lr_0 = 3.2994e-04
Loss = 1.0222e-02, PNorm = 35.4733, GNorm = 3.6277, lr_0 = 3.2906e-04
Validation auc = 0.964956
Epoch 16
Loss = 3.7450e-03, PNorm = 35.4862, GNorm = 2.3734, lr_0 = 3.2045e-04
Loss = 3.0189e-03, PNorm = 35.5058, GNorm = 1.0967, lr_0 = 3.1206e-04
Validation auc = 0.967636
Epoch 17
Loss = 2.7107e-03, PNorm = 35.5315, GNorm = 3.0739, lr_0 = 3.0309e-04
Loss = 3.0957e-03, PNorm = 35.5496, GNorm = 2.1117, lr_0 = 2.9515e-04
Loss = 3.0302e-03, PNorm = 35.5640, GNorm = 2.8992, lr_0 = 2.8743e-04
Validation auc = 0.964750
Epoch 18
Loss = 3.8852e-03, PNorm = 35.5831, GNorm = 1.8162, lr_0 = 2.7990e-04
Loss = 3.2767e-03, PNorm = 35.6024, GNorm = 0.5635, lr_0 = 2.7257e-04
Loss = 2.6156e-03, PNorm = 35.6292, GNorm = 0.3428, lr_0 = 2.6544e-04
Validation auc = 0.964028
Epoch 19
Loss = 4.1857e-03, PNorm = 35.6488, GNorm = 1.2899, lr_0 = 2.5780e-04
Loss = 2.4572e-03, PNorm = 35.6640, GNorm = 0.4063, lr_0 = 2.5106e-04
Loss = 2.7454e-03, PNorm = 35.6781, GNorm = 0.8942, lr_0 = 2.4448e-04
Validation auc = 0.962276
Epoch 20
Loss = 3.6945e-03, PNorm = 35.7060, GNorm = 2.1180, lr_0 = 2.3808e-04
Loss = 2.7977e-03, PNorm = 35.7244, GNorm = 1.8566, lr_0 = 2.3185e-04
Loss = 3.5779e-03, PNorm = 35.7378, GNorm = 2.0332, lr_0 = 2.2578e-04
Validation auc = 0.966193
Epoch 21
Loss = 4.4116e-03, PNorm = 35.7540, GNorm = 2.1056, lr_0 = 2.1929e-04
Loss = 3.1843e-03, PNorm = 35.7675, GNorm = 0.9270, lr_0 = 2.1355e-04
Loss = 2.8729e-03, PNorm = 35.7797, GNorm = 1.1349, lr_0 = 2.0796e-04
Validation auc = 0.968666
Epoch 22
Loss = 1.5714e-03, PNorm = 35.7949, GNorm = 1.4843, lr_0 = 2.0198e-04
Loss = 2.6706e-03, PNorm = 35.8124, GNorm = 1.5957, lr_0 = 1.9669e-04
Loss = 3.3377e-03, PNorm = 35.8254, GNorm = 1.5168, lr_0 = 1.9154e-04
Validation auc = 0.968769
Epoch 23
Loss = 2.5557e-03, PNorm = 35.8391, GNorm = 2.4127, lr_0 = 1.8653e-04
Loss = 3.4909e-03, PNorm = 35.8484, GNorm = 0.8020, lr_0 = 1.8164e-04
Loss = 2.4192e-03, PNorm = 35.8610, GNorm = 1.2145, lr_0 = 1.7689e-04
Validation auc = 0.967739
Epoch 24
Loss = 3.6133e-03, PNorm = 35.8807, GNorm = 1.0709, lr_0 = 1.7180e-04
Loss = 2.6241e-03, PNorm = 35.8965, GNorm = 0.8028, lr_0 = 1.6730e-04
Loss = 2.6103e-03, PNorm = 35.9085, GNorm = 2.0433, lr_0 = 1.6292e-04
Validation auc = 0.968254
Epoch 25
Loss = 2.2748e-03, PNorm = 35.9239, GNorm = 0.9658, lr_0 = 1.5866e-04
Loss = 1.8136e-03, PNorm = 35.9420, GNorm = 0.4225, lr_0 = 1.5450e-04
Loss = 2.7569e-03, PNorm = 35.9526, GNorm = 1.5796, lr_0 = 1.5046e-04
Validation auc = 0.971965
Epoch 26
Loss = 2.1293e-03, PNorm = 35.9582, GNorm = 1.2168, lr_0 = 1.4613e-04
Loss = 3.3920e-03, PNorm = 35.9662, GNorm = 2.9393, lr_0 = 1.4231e-04
Loss = 2.4611e-03, PNorm = 35.9751, GNorm = 4.7159, lr_0 = 1.3858e-04
Validation auc = 0.968357
Epoch 27
Loss = 3.2795e-03, PNorm = 35.9858, GNorm = 1.0227, lr_0 = 1.3460e-04
Loss = 2.2730e-03, PNorm = 35.9934, GNorm = 1.6623, lr_0 = 1.3107e-04
Loss = 2.5694e-03, PNorm = 36.0056, GNorm = 0.4414, lr_0 = 1.2764e-04
Validation auc = 0.970625
Epoch 28
Loss = 1.9531e-03, PNorm = 36.0161, GNorm = 1.2038, lr_0 = 1.2430e-04
Loss = 3.2402e-03, PNorm = 36.0255, GNorm = 0.8734, lr_0 = 1.2105e-04
Loss = 2.3473e-03, PNorm = 36.0358, GNorm = 1.3112, lr_0 = 1.1788e-04
Validation auc = 0.971243
Epoch 29
Loss = 2.6009e-03, PNorm = 36.0452, GNorm = 1.6534, lr_0 = 1.1449e-04
Loss = 2.0785e-03, PNorm = 36.0544, GNorm = 0.6538, lr_0 = 1.1149e-04
Loss = 2.0630e-03, PNorm = 36.0639, GNorm = 0.6153, lr_0 = 1.0857e-04
Validation auc = 0.966914
Model 0 best validation auc = 0.971965 on epoch 25
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test auc = 0.987503
Building model 1
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 354,901
Epoch 0
Loss = 1.2725e-02, PNorm = 34.0442, GNorm = 0.4148, lr_0 = 2.5968e-04
Loss = 1.0560e-02, PNorm = 34.0810, GNorm = 0.4842, lr_0 = 4.0484e-04
Validation auc = 0.899505
Epoch 1
Loss = 8.0256e-03, PNorm = 34.1537, GNorm = 0.7036, lr_0 = 5.6452e-04
Loss = 6.4200e-03, PNorm = 34.2039, GNorm = 0.6858, lr_0 = 7.0968e-04
Loss = 5.4320e-03, PNorm = 34.2532, GNorm = 1.3301, lr_0 = 8.5484e-04
Validation auc = 0.924552
Epoch 2
Loss = 6.1678e-03, PNorm = 34.2853, GNorm = 1.0436, lr_0 = 9.9735e-04
Loss = 6.3161e-03, PNorm = 34.3528, GNorm = 2.5855, lr_0 = 9.7124e-04
Loss = 6.5210e-03, PNorm = 34.3898, GNorm = 2.2147, lr_0 = 9.4582e-04
Validation auc = 0.926613
Epoch 3
Loss = 5.7345e-03, PNorm = 34.4361, GNorm = 1.1914, lr_0 = 9.2106e-04
Loss = 5.2806e-03, PNorm = 34.4899, GNorm = 0.9874, lr_0 = 8.9694e-04
Loss = 5.4810e-03, PNorm = 34.5260, GNorm = 1.8237, lr_0 = 8.7346e-04
Validation auc = 0.925170
Epoch 4
Loss = 7.2788e-03, PNorm = 34.5703, GNorm = 0.9375, lr_0 = 8.4834e-04
Loss = 5.1685e-03, PNorm = 34.6091, GNorm = 1.0245, lr_0 = 8.2613e-04
Loss = 5.2327e-03, PNorm = 34.6458, GNorm = 0.6227, lr_0 = 8.0451e-04
Validation auc = 0.930736
Epoch 5
Loss = 5.1448e-03, PNorm = 34.6851, GNorm = 0.7997, lr_0 = 7.8345e-04
Loss = 4.6961e-03, PNorm = 34.7151, GNorm = 0.3675, lr_0 = 7.6294e-04
Loss = 4.3521e-03, PNorm = 34.7526, GNorm = 1.4077, lr_0 = 7.4296e-04
Validation auc = 0.941043
Epoch 6
Loss = 3.6844e-03, PNorm = 34.7850, GNorm = 1.2367, lr_0 = 7.2160e-04
Loss = 4.2426e-03, PNorm = 34.8236, GNorm = 1.9603, lr_0 = 7.0271e-04
Loss = 5.3883e-03, PNorm = 34.8355, GNorm = 2.0683, lr_0 = 6.8431e-04
Validation auc = 0.950010
Epoch 7
Loss = 4.9223e-03, PNorm = 34.8632, GNorm = 3.2317, lr_0 = 6.6463e-04
Loss = 3.9316e-03, PNorm = 34.8864, GNorm = 0.7825, lr_0 = 6.4723e-04
Loss = 4.7669e-03, PNorm = 34.9054, GNorm = 1.6161, lr_0 = 6.3029e-04
Validation auc = 0.944754
Epoch 8
Loss = 4.0761e-03, PNorm = 34.9314, GNorm = 1.2655, lr_0 = 6.1379e-04
Loss = 4.1374e-03, PNorm = 34.9680, GNorm = 1.3249, lr_0 = 5.9772e-04
Loss = 4.3672e-03, PNorm = 34.9951, GNorm = 0.7728, lr_0 = 5.8207e-04
Validation auc = 0.952690
Epoch 9
Loss = 4.1345e-03, PNorm = 35.0179, GNorm = 1.0931, lr_0 = 5.6533e-04
Loss = 3.9649e-03, PNorm = 35.0382, GNorm = 2.3804, lr_0 = 5.5053e-04
Loss = 3.7466e-03, PNorm = 35.0634, GNorm = 1.3493, lr_0 = 5.3612e-04
Validation auc = 0.950113
Epoch 10
Loss = 2.8517e-03, PNorm = 35.0813, GNorm = 1.0820, lr_0 = 5.2209e-04
Loss = 3.9686e-03, PNorm = 35.1033, GNorm = 0.9373, lr_0 = 5.0842e-04
Loss = 4.2194e-03, PNorm = 35.1250, GNorm = 0.6360, lr_0 = 4.9511e-04
Validation auc = 0.947434
Epoch 11
Loss = 4.7769e-03, PNorm = 35.1424, GNorm = 1.8668, lr_0 = 4.8087e-04
Loss = 3.9821e-03, PNorm = 35.1587, GNorm = 1.0101, lr_0 = 4.6828e-04
Loss = 3.3654e-03, PNorm = 35.1868, GNorm = 1.4607, lr_0 = 4.5602e-04
Validation auc = 0.951350
Epoch 12
Loss = 3.1875e-03, PNorm = 35.2125, GNorm = 1.6391, lr_0 = 4.4291e-04
Loss = 3.0177e-03, PNorm = 35.2371, GNorm = 1.7789, lr_0 = 4.3131e-04
Loss = 3.0705e-03, PNorm = 35.2568, GNorm = 0.5134, lr_0 = 4.2002e-04
Validation auc = 0.960730
Epoch 13
Loss = 2.9214e-03, PNorm = 35.2928, GNorm = 2.2581, lr_0 = 4.0903e-04
Loss = 2.8269e-03, PNorm = 35.3207, GNorm = 0.6864, lr_0 = 3.9832e-04
Loss = 4.2306e-03, PNorm = 35.3444, GNorm = 1.2205, lr_0 = 3.8789e-04
Validation auc = 0.951247
Epoch 14
Loss = 3.2592e-03, PNorm = 35.3544, GNorm = 1.0028, lr_0 = 3.7674e-04
Loss = 3.5840e-03, PNorm = 35.3737, GNorm = 1.6672, lr_0 = 3.6687e-04
Loss = 3.5865e-03, PNorm = 35.3919, GNorm = 0.9342, lr_0 = 3.5727e-04
Validation auc = 0.951144
Epoch 15
Loss = 3.5278e-03, PNorm = 35.4137, GNorm = 1.7012, lr_0 = 3.4792e-04
Loss = 3.1153e-03, PNorm = 35.4398, GNorm = 0.6436, lr_0 = 3.3881e-04
Loss = 3.0783e-03, PNorm = 35.4554, GNorm = 3.0829, lr_0 = 3.2994e-04
Loss = 2.7355e-03, PNorm = 35.4575, GNorm = 1.3335, lr_0 = 3.2906e-04
Validation auc = 0.959390
Epoch 16
Loss = 3.6905e-03, PNorm = 35.4677, GNorm = 1.2246, lr_0 = 3.2045e-04
Loss = 3.1992e-03, PNorm = 35.4795, GNorm = 0.9472, lr_0 = 3.1206e-04
Validation auc = 0.961864
Epoch 17
Loss = 2.5200e-03, PNorm = 35.4970, GNorm = 0.8961, lr_0 = 3.0309e-04
Loss = 2.7378e-03, PNorm = 35.5215, GNorm = 3.0684, lr_0 = 2.9515e-04
Loss = 3.7356e-03, PNorm = 35.5361, GNorm = 1.6008, lr_0 = 2.8743e-04
Validation auc = 0.961657
Epoch 18
Loss = 2.6713e-03, PNorm = 35.5515, GNorm = 1.8366, lr_0 = 2.7990e-04
Loss = 2.3347e-03, PNorm = 35.5699, GNorm = 0.7058, lr_0 = 2.7257e-04
Loss = 2.6148e-03, PNorm = 35.5936, GNorm = 1.0387, lr_0 = 2.6544e-04
Validation auc = 0.965574
Epoch 19
Loss = 3.1276e-03, PNorm = 35.6088, GNorm = 0.9619, lr_0 = 2.5780e-04
Loss = 2.6784e-03, PNorm = 35.6235, GNorm = 0.5428, lr_0 = 2.5106e-04
Loss = 2.6245e-03, PNorm = 35.6385, GNorm = 0.8503, lr_0 = 2.4448e-04
Validation auc = 0.955782
Epoch 20
Loss = 2.6106e-03, PNorm = 35.6594, GNorm = 0.9191, lr_0 = 2.3808e-04
Loss = 2.9279e-03, PNorm = 35.6723, GNorm = 1.0618, lr_0 = 2.3185e-04
Loss = 2.8992e-03, PNorm = 35.6904, GNorm = 0.7088, lr_0 = 2.2578e-04
Validation auc = 0.966296
Epoch 21
Loss = 3.3299e-03, PNorm = 35.7010, GNorm = 0.3271, lr_0 = 2.1929e-04
Loss = 2.5335e-03, PNorm = 35.7173, GNorm = 0.6062, lr_0 = 2.1355e-04
Loss = 3.0423e-03, PNorm = 35.7340, GNorm = 0.4436, lr_0 = 2.0796e-04
Validation auc = 0.960008
Epoch 22
Loss = 2.8630e-03, PNorm = 35.7496, GNorm = 0.5405, lr_0 = 2.0198e-04
Loss = 2.3964e-03, PNorm = 35.7643, GNorm = 0.7206, lr_0 = 1.9669e-04
Loss = 2.8708e-03, PNorm = 35.7738, GNorm = 1.0533, lr_0 = 1.9154e-04
Validation auc = 0.963410
Epoch 23
Loss = 3.4019e-03, PNorm = 35.7873, GNorm = 1.1350, lr_0 = 1.8653e-04
Loss = 2.4458e-03, PNorm = 35.7993, GNorm = 3.2663, lr_0 = 1.8164e-04
Loss = 2.9138e-03, PNorm = 35.8181, GNorm = 1.6166, lr_0 = 1.7689e-04
Validation auc = 0.968975
Epoch 24
Loss = 2.5329e-03, PNorm = 35.8331, GNorm = 2.6983, lr_0 = 1.7180e-04
Loss = 2.7080e-03, PNorm = 35.8447, GNorm = 1.6951, lr_0 = 1.6730e-04
Loss = 3.2131e-03, PNorm = 35.8532, GNorm = 2.0043, lr_0 = 1.6292e-04
Validation auc = 0.965986
Epoch 25
Loss = 3.1277e-03, PNorm = 35.8673, GNorm = 1.6395, lr_0 = 1.5866e-04
Loss = 2.2715e-03, PNorm = 35.8819, GNorm = 0.7545, lr_0 = 1.5450e-04
Loss = 2.0600e-03, PNorm = 35.8943, GNorm = 0.5529, lr_0 = 1.5046e-04
Validation auc = 0.965471
Epoch 26
Loss = 2.5979e-03, PNorm = 35.9030, GNorm = 1.7594, lr_0 = 1.4613e-04
Loss = 2.4636e-03, PNorm = 35.9104, GNorm = 1.7437, lr_0 = 1.4231e-04
Loss = 2.8227e-03, PNorm = 35.9225, GNorm = 0.7116, lr_0 = 1.3858e-04
Validation auc = 0.966089
Epoch 27
Loss = 2.8447e-03, PNorm = 35.9324, GNorm = 2.0290, lr_0 = 1.3460e-04
Loss = 2.4114e-03, PNorm = 35.9415, GNorm = 0.5952, lr_0 = 1.3107e-04
Loss = 2.3036e-03, PNorm = 35.9503, GNorm = 0.6232, lr_0 = 1.2764e-04
Validation auc = 0.967223
Epoch 28
Loss = 1.9613e-03, PNorm = 35.9604, GNorm = 0.8759, lr_0 = 1.2430e-04
Loss = 2.5915e-03, PNorm = 35.9699, GNorm = 1.3140, lr_0 = 1.2105e-04
Loss = 2.9097e-03, PNorm = 35.9794, GNorm = 1.7511, lr_0 = 1.1788e-04
Validation auc = 0.968460
Epoch 29
Loss = 3.3638e-03, PNorm = 35.9876, GNorm = 1.0698, lr_0 = 1.1449e-04
Loss = 2.6269e-03, PNorm = 35.9958, GNorm = 1.6466, lr_0 = 1.1149e-04
Loss = 1.8345e-03, PNorm = 36.0035, GNorm = 0.5712, lr_0 = 1.0857e-04
Validation auc = 0.967429
Model 1 best validation auc = 0.968975 on epoch 23
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 1 test auc = 0.988226
Building model 2
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 354,901
Epoch 0
Loss = 1.3091e-02, PNorm = 34.0159, GNorm = 0.4836, lr_0 = 2.5968e-04
Loss = 1.0408e-02, PNorm = 34.0559, GNorm = 0.4054, lr_0 = 4.0484e-04
Validation auc = 0.913317
Epoch 1
Loss = 5.5816e-03, PNorm = 34.1355, GNorm = 0.4480, lr_0 = 5.6452e-04
Loss = 7.0424e-03, PNorm = 34.2055, GNorm = 1.6047, lr_0 = 7.0968e-04
Loss = 6.0392e-03, PNorm = 34.2421, GNorm = 0.8473, lr_0 = 8.5484e-04
Validation auc = 0.914760
Epoch 2
Loss = 6.5360e-03, PNorm = 34.2958, GNorm = 0.8282, lr_0 = 9.9735e-04
Loss = 6.2724e-03, PNorm = 34.3391, GNorm = 2.4538, lr_0 = 9.7124e-04
Loss = 6.1438e-03, PNorm = 34.3776, GNorm = 0.6612, lr_0 = 9.4582e-04
Validation auc = 0.929705
Epoch 3
Loss = 6.1923e-03, PNorm = 34.4175, GNorm = 0.4085, lr_0 = 9.2106e-04
Loss = 5.3959e-03, PNorm = 34.4591, GNorm = 0.9818, lr_0 = 8.9694e-04
Loss = 5.1562e-03, PNorm = 34.4944, GNorm = 0.6094, lr_0 = 8.7346e-04
Validation auc = 0.932076
Epoch 4
Loss = 7.5776e-03, PNorm = 34.5245, GNorm = 2.7363, lr_0 = 8.4834e-04
Loss = 4.9264e-03, PNorm = 34.5573, GNorm = 0.7120, lr_0 = 8.2613e-04
Loss = 5.1038e-03, PNorm = 34.6011, GNorm = 1.2325, lr_0 = 8.0451e-04
Validation auc = 0.938672
Epoch 5
Loss = 4.5330e-03, PNorm = 34.6352, GNorm = 1.2631, lr_0 = 7.8345e-04
Loss = 4.1270e-03, PNorm = 34.6829, GNorm = 1.9985, lr_0 = 7.6294e-04
Loss = 3.2375e-03, PNorm = 34.7295, GNorm = 0.3942, lr_0 = 7.4296e-04
Validation auc = 0.938363
Epoch 6
Loss = 3.7462e-03, PNorm = 34.7535, GNorm = 0.6176, lr_0 = 7.2160e-04
Loss = 4.2114e-03, PNorm = 34.7724, GNorm = 0.8945, lr_0 = 7.0271e-04
Loss = 3.6932e-03, PNorm = 34.7927, GNorm = 1.1589, lr_0 = 6.8431e-04
Validation auc = 0.946815
Epoch 7
Loss = 4.0960e-03, PNorm = 34.8120, GNorm = 1.4474, lr_0 = 6.6463e-04
Loss = 4.3364e-03, PNorm = 34.8410, GNorm = 2.4646, lr_0 = 6.4723e-04
Loss = 3.4222e-03, PNorm = 34.8673, GNorm = 0.8689, lr_0 = 6.3029e-04
Validation auc = 0.949701
Epoch 8
Loss = 5.0019e-03, PNorm = 34.8928, GNorm = 3.8968, lr_0 = 6.1379e-04
Loss = 4.2929e-03, PNorm = 34.9194, GNorm = 0.8413, lr_0 = 5.9772e-04
Loss = 3.4115e-03, PNorm = 34.9503, GNorm = 0.7708, lr_0 = 5.8207e-04
Validation auc = 0.950010
Epoch 9
Loss = 3.3681e-03, PNorm = 34.9825, GNorm = 1.9408, lr_0 = 5.6533e-04
Loss = 3.4128e-03, PNorm = 35.0109, GNorm = 0.5455, lr_0 = 5.5053e-04
Loss = 3.8153e-03, PNorm = 35.0362, GNorm = 0.4596, lr_0 = 5.3612e-04
Validation auc = 0.959802
Epoch 10
Loss = 3.8685e-03, PNorm = 35.0633, GNorm = 1.2296, lr_0 = 5.2209e-04
Loss = 3.6768e-03, PNorm = 35.0831, GNorm = 1.6313, lr_0 = 5.0842e-04
Loss = 3.8147e-03, PNorm = 35.1098, GNorm = 1.2300, lr_0 = 4.9511e-04
Validation auc = 0.958256
Epoch 11
Loss = 3.1847e-03, PNorm = 35.1357, GNorm = 0.5230, lr_0 = 4.8087e-04
Loss = 4.4357e-03, PNorm = 35.1549, GNorm = 2.8009, lr_0 = 4.6828e-04
Loss = 3.8652e-03, PNorm = 35.1802, GNorm = 1.2049, lr_0 = 4.5602e-04
Validation auc = 0.956916
Epoch 12
Loss = 3.2205e-03, PNorm = 35.2066, GNorm = 2.6979, lr_0 = 4.4291e-04
Loss = 3.5025e-03, PNorm = 35.2271, GNorm = 0.7087, lr_0 = 4.3131e-04
Loss = 3.4602e-03, PNorm = 35.2517, GNorm = 0.7244, lr_0 = 4.2002e-04
Validation auc = 0.965883
Epoch 13
Loss = 2.5309e-03, PNorm = 35.2790, GNorm = 0.5027, lr_0 = 4.0903e-04
Loss = 3.4889e-03, PNorm = 35.2985, GNorm = 1.1736, lr_0 = 3.9832e-04
Loss = 3.7807e-03, PNorm = 35.3201, GNorm = 0.6789, lr_0 = 3.8789e-04
Validation auc = 0.958771
Epoch 14
Loss = 3.1223e-03, PNorm = 35.3419, GNorm = 0.4459, lr_0 = 3.7674e-04
Loss = 2.7833e-03, PNorm = 35.3643, GNorm = 0.5274, lr_0 = 3.6687e-04
Loss = 3.7906e-03, PNorm = 35.3860, GNorm = 1.1197, lr_0 = 3.5727e-04
Validation auc = 0.967532
Epoch 15
Loss = 3.4717e-03, PNorm = 35.4015, GNorm = 1.1208, lr_0 = 3.4792e-04
Loss = 3.2558e-03, PNorm = 35.4209, GNorm = 0.8647, lr_0 = 3.3881e-04
Loss = 3.0464e-03, PNorm = 35.4506, GNorm = 2.1257, lr_0 = 3.2994e-04
Loss = 7.4948e-03, PNorm = 35.4530, GNorm = 2.4269, lr_0 = 3.2906e-04
Validation auc = 0.954545
Epoch 16
Loss = 3.1860e-03, PNorm = 35.4826, GNorm = 0.4324, lr_0 = 3.2045e-04
Loss = 3.4375e-03, PNorm = 35.5031, GNorm = 0.7601, lr_0 = 3.1206e-04
Validation auc = 0.964028
Epoch 17
Loss = 2.7691e-03, PNorm = 35.5204, GNorm = 1.6304, lr_0 = 3.0309e-04
Loss = 3.7244e-03, PNorm = 35.5394, GNorm = 0.8806, lr_0 = 2.9515e-04
Loss = 2.6086e-03, PNorm = 35.5594, GNorm = 2.6394, lr_0 = 2.8743e-04
Validation auc = 0.964337
Epoch 18
Loss = 3.9964e-03, PNorm = 35.5810, GNorm = 1.2544, lr_0 = 2.7990e-04
Loss = 3.3858e-03, PNorm = 35.6062, GNorm = 1.5423, lr_0 = 2.7257e-04
Loss = 2.9465e-03, PNorm = 35.6245, GNorm = 0.7684, lr_0 = 2.6544e-04
Validation auc = 0.961760
Epoch 19
Loss = 2.0563e-03, PNorm = 35.6500, GNorm = 1.1588, lr_0 = 2.5780e-04
Loss = 2.7434e-03, PNorm = 35.6644, GNorm = 1.2807, lr_0 = 2.5106e-04
Loss = 3.1533e-03, PNorm = 35.6774, GNorm = 1.4675, lr_0 = 2.4448e-04
Validation auc = 0.962894
Epoch 20
Loss = 1.7617e-03, PNorm = 35.6941, GNorm = 0.6569, lr_0 = 2.3808e-04
Loss = 2.8891e-03, PNorm = 35.7114, GNorm = 0.6889, lr_0 = 2.3185e-04
Loss = 2.4210e-03, PNorm = 35.7285, GNorm = 0.6398, lr_0 = 2.2578e-04
Validation auc = 0.965162
Epoch 21
Loss = 3.2602e-03, PNorm = 35.7413, GNorm = 1.7389, lr_0 = 2.1929e-04
Loss = 2.6878e-03, PNorm = 35.7576, GNorm = 0.4102, lr_0 = 2.1355e-04
Loss = 2.7386e-03, PNorm = 35.7753, GNorm = 3.2580, lr_0 = 2.0796e-04
Validation auc = 0.963616
Epoch 22
Loss = 2.9116e-03, PNorm = 35.7877, GNorm = 1.4399, lr_0 = 2.0198e-04
Loss = 2.6129e-03, PNorm = 35.8008, GNorm = 1.2828, lr_0 = 1.9669e-04
Loss = 2.6839e-03, PNorm = 35.8162, GNorm = 0.6773, lr_0 = 1.9154e-04
Validation auc = 0.966193
Epoch 23
Loss = 2.3213e-03, PNorm = 35.8321, GNorm = 0.4188, lr_0 = 1.8653e-04
Loss = 2.3076e-03, PNorm = 35.8483, GNorm = 1.6809, lr_0 = 1.8164e-04
Loss = 2.9392e-03, PNorm = 35.8594, GNorm = 3.2911, lr_0 = 1.7689e-04
Validation auc = 0.967945
Epoch 24
Loss = 3.7893e-03, PNorm = 35.8695, GNorm = 2.9643, lr_0 = 1.7180e-04
Loss = 2.3430e-03, PNorm = 35.8814, GNorm = 1.3251, lr_0 = 1.6730e-04
Loss = 2.6504e-03, PNorm = 35.8900, GNorm = 1.2557, lr_0 = 1.6292e-04
Validation auc = 0.965368
Epoch 25
Loss = 2.6379e-03, PNorm = 35.9012, GNorm = 0.8043, lr_0 = 1.5866e-04
Loss = 2.6099e-03, PNorm = 35.9078, GNorm = 0.5509, lr_0 = 1.5450e-04
Loss = 2.6147e-03, PNorm = 35.9200, GNorm = 1.8486, lr_0 = 1.5046e-04
Validation auc = 0.964750
Epoch 26
Loss = 2.4820e-03, PNorm = 35.9344, GNorm = 1.1238, lr_0 = 1.4613e-04
Loss = 2.1275e-03, PNorm = 35.9466, GNorm = 1.9858, lr_0 = 1.4231e-04
Loss = 2.8357e-03, PNorm = 35.9571, GNorm = 2.2011, lr_0 = 1.3858e-04
Validation auc = 0.968460
Epoch 27
Loss = 2.4042e-03, PNorm = 35.9690, GNorm = 1.4427, lr_0 = 1.3460e-04
Loss = 2.0407e-03, PNorm = 35.9778, GNorm = 0.8595, lr_0 = 1.3107e-04
Loss = 2.2074e-03, PNorm = 35.9864, GNorm = 0.9106, lr_0 = 1.2764e-04
Validation auc = 0.969491
Epoch 28
Loss = 2.4866e-03, PNorm = 35.9924, GNorm = 3.3609, lr_0 = 1.2430e-04
Loss = 2.8428e-03, PNorm = 36.0017, GNorm = 1.9692, lr_0 = 1.2105e-04
Loss = 2.7924e-03, PNorm = 36.0084, GNorm = 1.9737, lr_0 = 1.1788e-04
Validation auc = 0.971243
Epoch 29
Loss = 2.4004e-03, PNorm = 36.0189, GNorm = 0.6865, lr_0 = 1.1449e-04
Loss = 2.0709e-03, PNorm = 36.0282, GNorm = 0.6661, lr_0 = 1.1149e-04
Loss = 2.5320e-03, PNorm = 36.0355, GNorm = 0.8856, lr_0 = 1.0857e-04
Validation auc = 0.966811
Model 2 best validation auc = 0.971243 on epoch 28
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 2 test auc = 0.989981
Building model 3
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 354,901
Epoch 0
Loss = 1.2976e-02, PNorm = 33.9919, GNorm = 0.4189, lr_0 = 2.5968e-04
Loss = 1.0547e-02, PNorm = 34.0282, GNorm = 0.4954, lr_0 = 4.0484e-04
Validation auc = 0.913523
Epoch 1
Loss = 4.1776e-03, PNorm = 34.1160, GNorm = 0.7553, lr_0 = 5.6452e-04
Loss = 5.5816e-03, PNorm = 34.1925, GNorm = 1.0179, lr_0 = 7.0968e-04
Loss = 6.1869e-03, PNorm = 34.2220, GNorm = 2.2612, lr_0 = 8.5484e-04
Validation auc = 0.928984
Epoch 2
Loss = 7.3010e-03, PNorm = 34.2375, GNorm = 0.5813, lr_0 = 9.9735e-04
Loss = 5.3145e-03, PNorm = 34.2996, GNorm = 1.4042, lr_0 = 9.7124e-04
Loss = 5.6806e-03, PNorm = 34.3414, GNorm = 1.4157, lr_0 = 9.4582e-04
Validation auc = 0.935374
Epoch 3
Loss = 3.4541e-03, PNorm = 34.3713, GNorm = 0.8489, lr_0 = 9.2106e-04
Loss = 5.3379e-03, PNorm = 34.4022, GNorm = 4.3567, lr_0 = 8.9694e-04
Loss = 5.1140e-03, PNorm = 34.4169, GNorm = 1.6239, lr_0 = 8.7346e-04
Validation auc = 0.935374
Epoch 4
Loss = 7.1731e-03, PNorm = 34.4427, GNorm = 3.4781, lr_0 = 8.4834e-04
Loss = 4.8875e-03, PNorm = 34.4747, GNorm = 0.5930, lr_0 = 8.2613e-04
Loss = 5.3494e-03, PNorm = 34.5150, GNorm = 2.0312, lr_0 = 8.0451e-04
Validation auc = 0.940219
Epoch 5
Loss = 4.5547e-03, PNorm = 34.5402, GNorm = 0.4456, lr_0 = 7.8345e-04
Loss = 5.3880e-03, PNorm = 34.5624, GNorm = 0.8912, lr_0 = 7.6294e-04
Loss = 4.0799e-03, PNorm = 34.6032, GNorm = 1.9110, lr_0 = 7.4296e-04
Validation auc = 0.949083
Epoch 6
Loss = 5.0617e-03, PNorm = 34.6475, GNorm = 3.2199, lr_0 = 7.2160e-04
Loss = 4.4018e-03, PNorm = 34.6753, GNorm = 0.7823, lr_0 = 7.0271e-04
Loss = 4.4859e-03, PNorm = 34.7016, GNorm = 1.1544, lr_0 = 6.8431e-04
Validation auc = 0.943620
Epoch 7
Loss = 4.9748e-03, PNorm = 34.7186, GNorm = 1.1199, lr_0 = 6.6463e-04
Loss = 4.0341e-03, PNorm = 34.7416, GNorm = 1.8156, lr_0 = 6.4723e-04
Loss = 4.0201e-03, PNorm = 34.7731, GNorm = 0.6092, lr_0 = 6.3029e-04
Validation auc = 0.951144
Epoch 8
Loss = 3.7805e-03, PNorm = 34.7993, GNorm = 0.5008, lr_0 = 6.1379e-04
Loss = 3.7390e-03, PNorm = 34.8329, GNorm = 0.3753, lr_0 = 5.9772e-04
Loss = 4.0479e-03, PNorm = 34.8658, GNorm = 0.8728, lr_0 = 5.8207e-04
Validation auc = 0.952999
Epoch 9
Loss = 4.9281e-03, PNorm = 34.8956, GNorm = 0.8919, lr_0 = 5.6533e-04
Loss = 3.9473e-03, PNorm = 34.9320, GNorm = 0.7986, lr_0 = 5.5053e-04
Loss = 3.1147e-03, PNorm = 34.9554, GNorm = 0.2066, lr_0 = 5.3612e-04
Validation auc = 0.948773
Epoch 10
Loss = 3.1997e-03, PNorm = 34.9815, GNorm = 0.7785, lr_0 = 5.2209e-04
Loss = 4.2684e-03, PNorm = 35.0016, GNorm = 1.4644, lr_0 = 5.0842e-04
Loss = 4.2148e-03, PNorm = 35.0151, GNorm = 1.3635, lr_0 = 4.9511e-04
Validation auc = 0.953309
Epoch 11
Loss = 3.8722e-03, PNorm = 35.0570, GNorm = 0.6591, lr_0 = 4.8087e-04
Loss = 4.0002e-03, PNorm = 35.0826, GNorm = 0.3811, lr_0 = 4.6828e-04
Loss = 3.1578e-03, PNorm = 35.1097, GNorm = 1.4209, lr_0 = 4.5602e-04
Validation auc = 0.956916
Epoch 12
Loss = 3.6126e-03, PNorm = 35.1378, GNorm = 0.9064, lr_0 = 4.4291e-04
Loss = 3.4306e-03, PNorm = 35.1613, GNorm = 1.0220, lr_0 = 4.3131e-04
Loss = 3.4824e-03, PNorm = 35.1856, GNorm = 1.2393, lr_0 = 4.2002e-04
Validation auc = 0.959390
Epoch 13
Loss = 3.8817e-03, PNorm = 35.2131, GNorm = 1.9971, lr_0 = 4.0903e-04
Loss = 3.7199e-03, PNorm = 35.2429, GNorm = 0.8249, lr_0 = 3.9832e-04
Loss = 2.9926e-03, PNorm = 35.2604, GNorm = 1.0379, lr_0 = 3.8789e-04
Validation auc = 0.955679
Epoch 14
Loss = 3.7914e-03, PNorm = 35.2867, GNorm = 1.1655, lr_0 = 3.7674e-04
Loss = 3.0723e-03, PNorm = 35.3168, GNorm = 0.6341, lr_0 = 3.6687e-04
Loss = 3.2651e-03, PNorm = 35.3353, GNorm = 0.4428, lr_0 = 3.5727e-04
Validation auc = 0.960524
Epoch 15
Loss = 3.6030e-03, PNorm = 35.3547, GNorm = 0.8051, lr_0 = 3.4792e-04
Loss = 2.3765e-03, PNorm = 35.3717, GNorm = 0.7391, lr_0 = 3.3881e-04
Loss = 3.2714e-03, PNorm = 35.3921, GNorm = 1.9696, lr_0 = 3.2994e-04
Loss = 2.0900e-02, PNorm = 35.3920, GNorm = 4.5299, lr_0 = 3.2906e-04
Validation auc = 0.957947
Epoch 16
Loss = 2.8022e-03, PNorm = 35.4005, GNorm = 2.4407, lr_0 = 3.2045e-04
Loss = 3.1065e-03, PNorm = 35.4115, GNorm = 1.4806, lr_0 = 3.1206e-04
Validation auc = 0.964750
Epoch 17
Loss = 1.9632e-03, PNorm = 35.4424, GNorm = 0.9791, lr_0 = 3.0309e-04
Loss = 3.3305e-03, PNorm = 35.4691, GNorm = 1.3452, lr_0 = 2.9515e-04
Loss = 3.3189e-03, PNorm = 35.4913, GNorm = 1.2274, lr_0 = 2.8743e-04
Validation auc = 0.958978
Epoch 18
Loss = 3.2827e-03, PNorm = 35.5017, GNorm = 2.4215, lr_0 = 2.7990e-04
Loss = 4.0340e-03, PNorm = 35.5147, GNorm = 2.4413, lr_0 = 2.7257e-04
Loss = 2.5044e-03, PNorm = 35.5298, GNorm = 1.2960, lr_0 = 2.6544e-04
Validation auc = 0.962276
Epoch 19
Loss = 3.5137e-03, PNorm = 35.5475, GNorm = 1.1911, lr_0 = 2.5780e-04
Loss = 2.8555e-03, PNorm = 35.5631, GNorm = 1.2508, lr_0 = 2.5106e-04
Loss = 2.6784e-03, PNorm = 35.5795, GNorm = 1.1169, lr_0 = 2.4448e-04
Validation auc = 0.964853
Epoch 20
Loss = 2.3297e-03, PNorm = 35.5943, GNorm = 0.6216, lr_0 = 2.3808e-04
Loss = 3.1296e-03, PNorm = 35.6170, GNorm = 2.2016, lr_0 = 2.3185e-04
Loss = 2.6553e-03, PNorm = 35.6342, GNorm = 0.6947, lr_0 = 2.2578e-04
Validation auc = 0.960833
Epoch 21
Loss = 3.0083e-03, PNorm = 35.6500, GNorm = 0.7031, lr_0 = 2.1929e-04
Loss = 2.9829e-03, PNorm = 35.6672, GNorm = 0.7810, lr_0 = 2.1355e-04
Loss = 2.5710e-03, PNorm = 35.6814, GNorm = 1.4042, lr_0 = 2.0796e-04
Validation auc = 0.966708
Epoch 22
Loss = 3.3300e-03, PNorm = 35.6960, GNorm = 0.8060, lr_0 = 2.0198e-04
Loss = 2.3532e-03, PNorm = 35.7103, GNorm = 1.7172, lr_0 = 1.9669e-04
Loss = 2.8599e-03, PNorm = 35.7273, GNorm = 1.6249, lr_0 = 1.9154e-04
Validation auc = 0.970315
Epoch 23
Loss = 1.9716e-03, PNorm = 35.7415, GNorm = 1.2373, lr_0 = 1.8653e-04
Loss = 2.2291e-03, PNorm = 35.7551, GNorm = 2.1569, lr_0 = 1.8164e-04
Loss = 3.3603e-03, PNorm = 35.7665, GNorm = 1.0943, lr_0 = 1.7689e-04
Validation auc = 0.965574
Epoch 24
Loss = 2.8816e-03, PNorm = 35.7816, GNorm = 1.2741, lr_0 = 1.7180e-04
Loss = 2.6981e-03, PNorm = 35.7974, GNorm = 0.5098, lr_0 = 1.6730e-04
Loss = 2.2048e-03, PNorm = 35.8098, GNorm = 1.7521, lr_0 = 1.6292e-04
Validation auc = 0.970934
Epoch 25
Loss = 2.0741e-03, PNorm = 35.8183, GNorm = 2.7458, lr_0 = 1.5866e-04
Loss = 3.0691e-03, PNorm = 35.8284, GNorm = 1.7787, lr_0 = 1.5450e-04
Loss = 3.3394e-03, PNorm = 35.8416, GNorm = 3.7764, lr_0 = 1.5046e-04
Validation auc = 0.970831
Epoch 26
Loss = 3.2104e-03, PNorm = 35.8514, GNorm = 0.7916, lr_0 = 1.4613e-04
Loss = 2.3981e-03, PNorm = 35.8629, GNorm = 0.4813, lr_0 = 1.4231e-04
Loss = 2.9338e-03, PNorm = 35.8717, GNorm = 1.7420, lr_0 = 1.3858e-04
Validation auc = 0.966399
Epoch 27
Loss = 2.1680e-03, PNorm = 35.8799, GNorm = 0.4136, lr_0 = 1.3460e-04
Loss = 2.6259e-03, PNorm = 35.8907, GNorm = 1.6099, lr_0 = 1.3107e-04
Loss = 2.6631e-03, PNorm = 35.8940, GNorm = 1.3032, lr_0 = 1.2764e-04
Validation auc = 0.972892
Epoch 28
Loss = 2.6039e-03, PNorm = 35.9028, GNorm = 3.0155, lr_0 = 1.2430e-04
Loss = 2.4372e-03, PNorm = 35.9099, GNorm = 0.4613, lr_0 = 1.2105e-04
Loss = 2.9367e-03, PNorm = 35.9200, GNorm = 1.2427, lr_0 = 1.1788e-04
Validation auc = 0.970831
Epoch 29
Loss = 2.4012e-03, PNorm = 35.9270, GNorm = 1.8909, lr_0 = 1.1449e-04
Loss = 2.4274e-03, PNorm = 35.9346, GNorm = 0.7927, lr_0 = 1.1149e-04
Loss = 2.6071e-03, PNorm = 35.9421, GNorm = 2.5331, lr_0 = 1.0857e-04
Validation auc = 0.969388
Model 3 best validation auc = 0.972892 on epoch 27
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 3 test auc = 0.986573
Ensemble test auc = 0.988432
2-fold cross validation
	Seed 0 ==> test auc = 0.952957
	Seed 1 ==> test auc = 0.988432
Overall test auc = 0.970695 +/- 0.017738
Elapsed time = 2:10:31
